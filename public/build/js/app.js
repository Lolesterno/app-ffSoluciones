const cotizacion={id:id="",clienteId:clienteId="",productos:productos=[],total:total=0};function iniciarApp(){seleccionarProductos(),buscarCliente(),buscarProductos(),agregarProductoCotizacion(),buscarProductosTemporal(data)}document.addEventListener("DOMContentLoaded",(function(){iniciarApp()}));const nitCliente=document.querySelector("#nitCliente").addEventListener("keyup",(function(e){buscarCliente(e.target.value)})),idCliente=document.querySelector("#id_cliente"),razonSocial=document.querySelector("#razon"),telefonoCliente=document.querySelector("#telefono"),direccionCliente=document.querySelector("#direccion"),departamentoCliente=document.querySelector("#departamento"),ciudadCliente=document.querySelector("#ciudad");async function buscarCliente(e){try{const t="http://mysterious-bayou-89699/api/buscarClientes?nit="+e,o=await fetch(t),c=await o.json();"error"!=c&&(idCliente.value=c.id,razonSocial.value=c.razon_social,telefonoCliente.value=c.telefono,direccionCliente.value=c.direccion,departamentoCliente.value=c.departamentoId,ciudadCliente.value=c.ciudad)}catch(e){razonSocial.value="",telefonoCliente.value="",direccionCliente.value="",departamentoCliente.value="",ciudadCliente.value=""}}const codigoProducto=document.querySelector("#codigoProducto").addEventListener("keyup",(function(e){buscarProductos(e.target.value)})),productoNombre=document.querySelector("#nombreProducto"),descripcionProducto=document.querySelector("#descripcionProducto"),precioProducto=document.querySelector("#precioProducto"),idProducto=document.querySelector("#idProducto");async function buscarProductos(e){try{const t="http://mysterious-bayou-89699/api/buscarProductos?producto="+e,o=await fetch(t),c=await o.json();"error"!=c&&(productoNombre.value=c.nombre,descripcionProducto.value=c.descripcion,precioProducto.value="$."+parseInt(c.precio),precioProducto.setAttribute("value",c.precio),idProducto.value=c.id)}catch(e){productoNombre.value="",descripcionProducto.value="",precioProducto.value="",idProducto.value=""}}const agregarProducto=document.querySelector("#agregarProducto");async function mostrarProductos(){const e=await fetch("http://mysterious-bayou-89699/api/obtenerTemporal");mostrarProducto(await e.json())}function mostrarProducto(e){const t=document.querySelector(".detalles"),o=e.pop(),{cantidad:c,descuento:n,id:r,numero_producto:d,precio:a,producto:u}=o,i=document.createElement("p");i.classList.add("cod-producto"),i.textContent=d;const l=document.createElement("H3");l.textContent=u;const s=document.createElement("H3");s.textContent="$"+a;const p=document.createElement("DIV");p.classList.add("cantidades");const m=document.createElement("P");m.textContent=c+" Unidades";const C=document.createElement("P");C.textContent=n+"%",p.appendChild(m),p.appendChild(C);const P=a*c,y=P-P*n/100,v=document.createElement("H4");v.textContent="$."+y;const h=document.createElement("DIV");h.classList.add("producto"),h.dataset.idtemporal=r,h.appendChild(i),h.appendChild(l),h.appendChild(s),h.appendChild(p),h.appendChild(v),t.appendChild(h),mostrarTotal(y)}function mostrarTotal(e){const t=e,o=.19*t,c=t+o,n=document.querySelector(".total"),r=document.createElement("H4");r.textContent="$."+t;const d=document.createElement("P");d.textContent=o;const a=document.createElement("H3");a.textContent=c,n.appendChild(r),n.appendChild(d),n.appendChild(a);document.querySelector(".totales").appendChild(n)}agregarProducto.addEventListener("submit",(function(e){e.preventDefault();const t=new FormData(agregarProducto);fetch("http://mysterious-bayou-89699/api/temporal",{method:"POST",body:t}).then(e=>e.json()).then(e=>{mostrarProductos()})}));
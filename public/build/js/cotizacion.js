!function(){let e=[],t=[];n(e),o(),document.querySelector(".formlario-buscar-producto").addEventListener("click",(function(o){if(o.preventDefault(),o.target.classList.contains("boton-enviar")){if(""===document.querySelector("#codigo").value.trim())return void c("error","El producto es Obligatorio",document.querySelector(".paso2Titulo"));const o=document.querySelector("#idProducto").value,r=document.querySelector("#producto").value,d=document.querySelector("#precio").value,a=document.querySelector("#cantidad").value,u=document.querySelector("#descuento").value;productoAgregar={idProducto:o,nombre:r,precio:d,cantidad:a,descuento:u},async function(o){const c=new FormData;c.append("productoId",o.idProducto),c.append("cantidad",o.cantidad),c.append("precio",o.precio),c.append("descuento",o.descuento);try{const o="http://localhost:3000/api/temporal",r=await fetch(o,{method:"POST",body:c});!async function(o){const c="http://localhost:3000/api/buscarTemporal?token="+o.token,r=await fetch(c),d=await r.json();t=d.producto,function(){if(function(){const e=document.querySelector("#cotizador");for(;e.firstChild;)e.removeChild(e.firstChild)}(),0===t.length){const e=document.querySelector("#cotizador"),t=document.createElement("H3");return t.textContent="No hay Productos, Agrega uno desde el formulario de la izquierda",t.classList.add("no-cotizacion"),void e.appendChild(t)}t.forEach(t=>{const o=document.createElement("DIV");o.dataset.productoId=t.id,o.classList.add("productoDiv");const c=document.createElement("H3");c.textContent=t.nombre;const r=document.createElement("H4");r.textContent="$."+t.precio;const d=document.createElement("DIV");d.classList.add("cantidad-descuento");const a=document.createElement("P");a.textContent=t.cantidad+" UND";const u=document.createElement("P");u.textContent=t.descuento+"%";const i=t.precio*t.cantidad,l=i-i*t.descuento/100,s=document.createElement("H4");s.textContent="$."+l,d.appendChild(a),d.appendChild(u),o.appendChild(c),o.appendChild(r),o.appendChild(d),o.appendChild(s),document.querySelector("#cotizador").appendChild(o),productoprecio={total:l,idProducto:t.id},function(t){const o=n(e);console.log(o),document.querySelector(".procesar").addEventListener("click",(function(e){console.log(t)}))}(productoprecio)})}()}(await r.json())}catch(e){console.log(e)}}(productoAgregar)}})),document.querySelector("#codigo").addEventListener("keyup",(function(e){const t=e.target.value.trim();""!==t?async function(e){const t="http://localhost:3000/api/buscarProductos?producto="+e,o=await fetch(t),n=await o.json(),r=n.producto;"error"===n&&c(o.tipo,o.mensaje,document.querySelector(".paso2Titulo")),function(e){document.querySelector("#idProducto").value=e.id,document.querySelector("#producto").value=e.nombre,document.querySelector("#precio").value=e.precio}(r)}(t):c("error","El producto es Obligatorio",document.querySelector(".paso2Titulo"))}));async function o(e){try{const t="http://localhost:3000/api/buscarClientes?nit="+e,o=await fetch(t),c=await o.json();!function(e){const t=document.querySelector("#razon"),o=document.querySelector("#telefono"),c=document.querySelector("#direccion"),r=document.querySelector("#departamento"),d=document.querySelector("#ciudad");t.value=e.razon_social,o.value=e.telefono,c.value=e.direccion,r.value=e.departamentoId,d.value=e.ciudad,n({...e})}(c.cliente)}catch(e){console.log(e)}}function c(e,t,o){const c=document.querySelector(".alerta");c&&c.remove();const n=document.createElement("DIV");n.classList.add("alerta",e),n.textContent=t,o.parentElement.insertBefore(n,o.nextElementSibling),setTimeout(()=>{n.remove()},2500)}function n(e){console.log(e.id)}document.querySelector(".nitCliente").addEventListener("keyup",(function(e){o(e.target.value)}))}();
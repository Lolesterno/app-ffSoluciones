!function(){const e=window.location.origin;!async function(){try{const n=t(),o=`${e}/api/garantia?url=${n}`,r=await fetch(o),i=await r.json();a=i.garantia,function(){if(0===a.length){const e=document.querySelector("#listado-garantias"),a=document.createElement("LI");return a.textContent="No hay garantias para esta empresa",a.classList.add("no-tareas"),void e.appendChild(a)}const e={0:"Pendiente",1:"Aceptada",2:"Rechazada"};a.forEach(a=>{const t=document.createElement("LI");t.dataset.garantiaId=a.id,t.classList.add("garantiaDIV");const n=document.createElement("P");n.classList.add("seriales"),n.textContent=a.serialMedidor;const o=document.createElement("P");o.textContent=`Ingreso:  ${a.fecha} Hora: ${a.horaIngreso}`;const r=document.createElement("P");r.textContent=` Remision: ${a.tipoFactura.toUpperCase()} ${a.numeroFactura} `;const i=document.createElement("DIV");i.classList.add("opciones");const d=document.createElement("BUTTON");d.classList.add("estado-garantia"),d.classList.add(""+e[a.estado].toLowerCase()),d.dataset.estadoGarantia=a.estado,d.dataset.idGarantia=a.id,d.textContent="Generar PDF";const c=document.createElement("BUTTON");c.classList.add("aprobado"),c.dataset.idGarantia=a.id,c.textContent="Aceptar";const l=document.createElement("BUTTON");l.classList.add("rechazo"),l.dataset.idGarantia=a.id,l.textContent="Rechazar",i.appendChild(d),i.appendChild(c),i.appendChild(l),t.appendChild(n),t.appendChild(o),t.appendChild(r),t.appendChild(i),document.querySelector("#listado-garantia").appendChild(t),console.log(t)})}()}catch(e){console.log(e)}}();let a=[];function t(){const e=new URLSearchParams(window.location.search);return Object.fromEntries(e.entries()).url}function n(e,a,t){const n=document.querySelector(".alerta");n&&n.remove();const o=document.createElement("DIV");o.classList.add("alerta",a),o.textContent=e,t.parentElement.insertBefore(o,t.nextElementSibling),setTimeout(()=>{o.remove()},5e3)}document.querySelector("#agregar-garantia").addEventListener("click",(function(){const a=document.createElement("DIV");a.classList.add("modal"),a.innerHTML='\n            <form class="formulario" enctype="multipart/form-data">\n                <legend>Añade una nueva Garantia</legend>\n                <div class="campo">\n                    <label for="medidorId">Tipo de Medidor</label>\n                    <select name="medidorId" id="medidorId">\n                        <option value="1">CAM3050R200PRCAL</option>\n                        <option value="2">cam3075r160eqcal</option>\n                        <option value="3">cam3100r160eqcal</option>\n                    </select>\n                </div>\n                <div class="campo">\n                    <label for="serialMedidor">Serial del Medidor</label>\n                    <input type="text" name="serialMedidor" id="serialMedidor" placeholder="Serial del Medidor">\n                </div>\n                <div class="campo">\n                    <label for="tipoFactura">Tipo de Medidor</label>\n                    <select name="tipoFactura" id="tipoFactura">\n                        <option value="fs">FSFE</option>\n                        <option value="vc">VCFE</option>\n                        <option value="pos">POS</option>\n                    </select>\n                </div>\n                <div class="campo">\n                    <label for="numeroFactura">Número del la Factura</label>\n                    <input type="text" name="numeroFactura" id="numeroFactura" placeholder="Número de la factura">\n                </div>\n                <div class="campo">\n                    <label for="archivoGarantia">Soporte Fisico</label>\n                    <input type="file" name="archivoGarantia" id="archivoGarantia" accept=".pdf/*, image/*"> \n                </div>\n                <div class="opciones">\n                    <input type="submit" value="Crear Garantia" class="submit-nueva-garantia">\n                    <button type="button" class="cerrar-modal">Cancelar</button>\n                </div>\n            </form>\n        ',setTimeout(()=>{document.querySelector(".formulario").classList.add("animar")},0),a.addEventListener("click",(function(o){if(o.preventDefault(),o.target.classList.contains("cerrar-modal")){document.querySelector(".formulario").classList.add("cerrar"),setTimeout(()=>{a.remove()},500)}o.target.classList.contains("submit-nueva-garantia")&&function(){const a=document.querySelector("#serialMedidor").value.trim(),o=document.querySelector("#numeroFactura").value.trim(),r=document.querySelector("#tipoFactura").value,i=document.querySelector("#medidorId").value;if(a&&""!==o)return void async function(a,o,r,i){const d=new FormData;d.append("medidorId",i),d.append("serialMedidor",a),d.append("tipoFactura",r),d.append("numeroFactura",o),d.append("garantiaId",t());try{const a=e+"/api/garantia",t=await fetch(a,{method:"POST",body:d}),o=await t.json();if(n(o.mensaje,o.tipo,document.querySelector(".formulario legend")),"exito"===o.tipo){const e=document.querySelector(".modal");setTimeout(()=>{e.remove()},1500)}}catch(e){console.log(e)}}(a,o,r,i);n("Faltan datos ","error",document.querySelector(".formulario legend"))}()})),document.querySelector(".todo").appendChild(a)}))}();